![image](https://user-images.githubusercontent.com/90156264/221610945-566bd56b-282c-4780-bd4d-d845341e2c0c.png)

# Основные соображения

- бот будет один на все три типа пользователя: клиенты, подрядчики, админы (на стороне заказчика). У каждого свое кнопочное меню. Пользователи заносятся  в БД за рамками нашего проекта.
- пишем два модуля. Один отвечает за работу с ботами, другой - за работу с БД. Первый использует интерфейс второго, что даст возможность потом менять легко заменить БД если нужно.
- для модуля БД используем на текущем этапе SQLLite и стандартную библиотеку sqlite3. На уровне модуля бота исползуем словарь для кэширования оперативных данных общающихся с ботом пользователей
- для прогамммирования бота используем  pyTelegramBotAPI

# Модуль бота

## Команды бота

- start - стандартная команда запуска бота с приветствием и указанием какие команды можно дать (можно дать /help и /menu).
- help - описывает функционал кнопок меню.Опять же зависит от типа пользователя, который отправил сообщение в бот - не реализовано пока.
- menu - выводит основное меню пользователя (в заивисимости от того кем явяется пользователь давший команду)

## Кэш данных

- В модуле бота создаем словарь  словарей (chats), где будем хранить оперативные данные о всех пользователях, общающихся с ботом.  Словари в словаре отражают данные по конктреному чату, которые находим по ключу `chat_id`. 

# Таблицы БД

- **users** - пользователи бота. Предполагается что занесение данных о пользователях за рамками нашего проекта.
	- **name** - имя пользователя. Пока не используется
	- **tg_name** - имя в телеграмме 
	- **tg_user_id** - id пользователя в телеграмме 
	- **chat_id** - id чата пользователя в боте
	- **group** - группа пользователей (см. globals.py)
	- **access** - доступ к сервису. Указывает есть подписка (1) или нет (0)
- **orders** - заказы клиентов
	- **order_id** - PK 
	- **client_chat_id** - chat_id клиента, создавшего заказ 
	- **description** - описание задачи
	- **comments** - доработки, которые указывает клиент если не принимает работу. Либо когда отправляет комментарий исполнителю.
	- **credentials** - данные дла входя в админку сайта, предоставляемые клиентом
	- **ex_chat_id** - chat_id подрядчика, взявшегося за выполнение задачи. На текущем этапе подрядчик может брать только один заказ. Но код позволяет работать со многими заказами.
	- **question** - вопросы подрядчика клиенту. Пока здесь хранится только последний вопросы (скрипт позволяет задавать вопросы и получать ответы много раз, но их история пока только в чате бота)
	- **answer** - ответы клиента на вопросы подрядчика. По аналогии с вопросом
	- **status** - статус задачи (0-нет исполнителя, 1- в работе, 2 - есть вопросы подрядчика,  3 - клиент ответил, 4 подрядчик выполнил работу,  5 - на доработке, 6 - работа принята клиентом) 
	- **date_reg** - дата регистрации задачи
	- **date_appoint** - дата назначения исполнителя
	- **date_accepted** - дата приемки выполненной работы Клиентом
	- **estimation** - оценка времени от исполнителя, которую он дает при взятии заявки в работу.
